## edgeR figures plotting
## Clear workspace
rm(list=ls(all=T))

## Load libraries
library(ggplot2)
library(gplots)
library(dplyr)
library(devtools)

## Load data

heartVhippo <- read.table("DE.unstranded_heartVShippo.mm9.csv", header = T, sep="\t")
heartVliver <- read.table("DE.unstranded_heartVSliver.mm9.csv", header = T, sep="\t")
heartVlung  <- read.table("DE.unstranded_heartVSlung.mm9.csv", header = T, sep="\t")
hippoVliver <- read.table("DE.unstranded_hippoVSliver.mm9.csv", header = T, sep="\t")
hippoVlung  <- read.table("DE.unstranded_hippoVSlung.mm9.csv", header = T, sep="\t")

## Select data by strand and omit antisense transcript 8 from analysis
anti.hehi  <- subset(heartVhippo, Strand=="-", select=c(GeneID,logFC,logCPM,PValue,FDR))
anti.hehi  <- anti.hehi[ which(anti.hehi$GeneID != "MSTRG.2448.8"),]
sense.hehi <- subset(heartVhippo, Strand=="+", select=c(GeneID,logFC,logCPM,PValue,FDR))

anti.heli  <- subset(heartVliver, Strand=="-", select=c(GeneID,logFC,logCPM,PValue,FDR))
anti.heli  <- anti.heli[ which(anti.heli$GeneID != "MSTRG.2448.8"),]
sense.heli <- subset(heartVliver, Strand=="+", select=c(GeneID,logFC,logCPM,PValue,FDR))

anti.helu  <- subset(heartVlung, Strand=="-", select=c(GeneID,logFC,logCPM,PValue,FDR))
anti.helu  <- anti.helu[ which(anti.helu$GeneID != "MSTRG.2448.8"),]
sense.helu <- subset(heartVlung, Strand=="+", select=c(GeneID,logFC,logCPM,PValue,FDR))

anti.hili  <- subset(hippoVliver, Strand=="-", select=c(GeneID,logFC,logCPM,PValue,FDR))
anti.hili  <- anti.hili[ which(anti.hili$GeneID != "MSTRG.2448.8"),]
sense.hili <- subset(hippoVliver, Strand=="+", select=c(GeneID,logFC,logCPM,PValue,FDR))

anti.hilu  <- subset(hippoVlung, Strand=="-", select=c(GeneID,logFC,logCPM,PValue,FDR))
anti.hilu  <- anti.hilu[ which(anti.hilu$GeneID != "MSTRG.2448.8"),]
sense.hilu <- subset(hippoVlung, Strand=="+", select=c(GeneID,logFC,logCPM,PValue,FDR))

## Open device for figure output.
pdf(file="figures_output.edgeR.pdf")

## Set margins for graph
par(mar=c(8.2,4.5,3.8,1))

## par(mfrow=c(1,3))
barplot(anti.hehi$logFC, main = "DE: Heart VS Hippocampus", pch = 19, ylab = "logFC", ylim=c(0,2), names.arg=anti.hehi$GeneID, las = 2, col=1)
abline(h=1,lty=3)
barplot(anti.hili$logFC, main = "DE: Hippocampus VS Liver", pch = 19, ylab = "logFC", ylim=c(-2,0), names.arg=anti.hili$GeneID, las = 2, col=3)
abline(h=-1,lty=3)
barplot(anti.hilu$logFC, main = "DE: Hippocampus VS Lung", pch = 19, ylab = "logFC", ylim=c(-2,0), names.arg=anti.hilu$GeneID, las = 2, col=4)
abline(h=-1,lty=3)

## par(mfrow=c(1,2))
barplot(anti.heli$logFC, main = "DE: Heart VS Liver", pch = 19, ylab = "logFC", ylim=c(-2,0), names.arg=anti.heli$GeneID, las = 2, col=2)
abline(h=-1,lty=3)
barplot(anti.helu$logFC, main = "DE: Heart VS Lung", pch = 19, ylab = "logFC", ylim=c(-2,0), names.arg=anti.helu$GeneID, las = 2, col=5)
abline(h=-1,lty=3)

## par(mfrow=c(1,3))
barplot(sense.hehi$logFC, main = "DE: Heart VS Hippocampus", pch = 19, ylab = "logFC", ylim=c(-3,3), names.arg=sense.hehi$GeneID, las = 2, col=1)
abline(h=3,lty=3)
barplot(sense.hili$logFC, main = "DE: Hippocampus VS Liver", pch = 19, ylab = "logFC", ylim=c(-3,3), names.arg=sense.hili$GeneID, las = 2, col=3)
abline(h=-3,lty=3)
barplot(sense.hilu$logFC, main = "DE: Hippocampus VS Lung", pch = 19, ylab = "logFC", ylim=c(-3,3), names.arg=sense.hilu$GeneID, las = 2, col=4)
abline(h=-3,lty=3)

## par(mfrow=c(1,2))
barplot(sense.heli$logFC, main = "DE: Heart VS Liver", pch = 19, ylab = "logFC", ylim=c(-2,0), names.arg=sense.heli$GeneID, las = 2, col=2)
abline(h=-1,lty=3)
barplot(sense.helu$logFC, main = "DE: Heart VS Lung", pch = 19, ylab = "logFC", ylim=c(-2,0), names.arg=sense.helu$GeneID, las = 2, col=5)
abline(h=-1,lty=3)

## The problem with plotting exon usage in edgeR is the need to plot unique exons. 
